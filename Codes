# H2 Configuration
spring.datasource.url=jdbc:h2:mem:testdb
spring.datasource.driverClassName=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=
spring.jpa.database-platform=org.hibernate.dialect.H2Dialect
spring.h2.console.enabled=true
spring.h2.console.path=/h2-console
spring.jpa.show-sql=true
spring.jpa.hibernate.ddl-auto=update




@Entity
public class MergedRecord {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    private String crdsCode;
    private String registrationAddress;
    private String country;
    private String siteBnpp;
    private String siteCountry;
    private String siteStatus;
    private String kycSegment;
    private String ric;
}



public interface MergedRecordRepository extends JpaRepository<MergedRecord, Long> {
}


import com.opencsv.CSVReader;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import java.io.FileReader;
import java.util.List;

@Service
public class CsvImportService {

    @Autowired
    private MergedRecordRepository repository;

    public void importCsvToH2(String filePath) {
        try (CSVReader reader = new CSVReader(new FileReader(filePath))) {
            String[] line;
            reader.readNext(); // skip header

            while ((line = reader.readNext()) != null) {
                MergedRecord record = new MergedRecord();
                record.setCrdsCode(line[0]);
                record.setRegistrationAddress(line[1]);
                record.setCountry(line[2]);
                record.setSiteBnpp(line[3]);
                record.setSiteCountry(line[4]);
                record.setSiteStatus(line[5]);
                record.setKycSegment(line[6]);
                record.setRic(line[7]);

                repository.save(record);
            }

        } catch (Exception e) {
            System.out.println("Error importing CSV: " + e.getMessage());
        }
    }
}





@Component
public class StartupRunner implements CommandLineRunner {

    @Autowired
    private CsvImportService csvImportService;

    @Override
    public void run(String... args) {
        csvImportService.importCsvToH2("merged_output.csv");
    }
}




