package com.example;

import org.jsonschema2pojo.DefaultGenerationConfig;
import org.jsonschema2pojo.GenerationConfig;
import org.jsonschema2pojo.Jackson2Annotator;
import org.jsonschema2pojo.SchemaMapper;
import org.jsonschema2pojo.SchemaStore;
import org.jsonschema2pojo.rules.RuleFactory;

import com.sun.codemodel.JCodeModel;

import java.io.File;
import java.net.URL;

public class PojoGenerator {

    public static void main(String[] args) throws Exception {
        // Input JSON file (can also be a schema)
        File inputJson = new File("src/main/resources/user.json");

        // Output directory for generated Java classes
        File outputJavaClassDirectory = new File("src/main/java");

        // Java package for generated classes
        String packageName = "com.example.generated";

        JCodeModel codeModel = new JCodeModel();

        GenerationConfig config = new DefaultGenerationConfig() {
            @Override
            public boolean isGenerateBuilders() { return true; }

            @Override
            public SourceType getSourceType() {
                return SourceType.JSON; // or JSONSCHEMA
            }
        };

        SchemaMapper mapper = new SchemaMapper(
                new RuleFactory(config, new Jackson2Annotator(config), new SchemaStore()),
                new SchemaGenerator());

        mapper.generate(codeModel, "User", packageName, inputJson.toURI().toURL());

        codeModel.build(outputJavaClassDirectory);

        System.out.println("POJO generated successfully in " + outputJavaClassDirectory.getAbsolutePath());
    }
}
